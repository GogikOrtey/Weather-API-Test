# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API —Å–µ—Ä–≤–∏—Å–∞ –ø–æ–≥–æ–¥—ã

# –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±—ã–ª –≤—ã–±—Ä–∞–Ω —Å–µ—Ä–≤–∏—Å WeatherAPI

import requests
import os
import sys

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —á—Ç–µ–Ω–∏—è API-–∫–ª—é—á–∞ –∏–∑ —Ñ–∞–π–ª–∞
def read_api_key(file_path):
    if not os.path.exists(file_path):
        print(f"‚ö†Ô∏è  –û—à–∏–±–∫–∞! –§–∞–π–ª {file_path} –Ω–µ –Ω–∞–π–¥–µ–Ω. \n–ü—Ä–æ–≥—Ä–∞–º–º–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞")
        sys.exit(0)  # –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å –æ—à–∏–±–∫–æ–π, –µ—Å–ª–∏ —Ñ–∞–π–ª —Å API-–∫–ª—é—á–æ–º –Ω–µ –Ω–∞–π–¥–µ–Ω
    with open(file_path, 'r') as file:
        return file.read().strip()

# –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–≥–æ–¥–µ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –≥–æ—Ä–æ–¥–µ
def get_weather(api_key, city):
    # –ü–æ—Å—ã–ª–∞–µ–º –∑–∞–ø—Ä–æ—Å
    url = f"http://api.weatherapi.com/v1/current.json?key={api_key}&q={city}"
    response = requests.get(url)
    
    # –î–∞–ª—å—à–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ª–∏ –æ—Ç–≤–µ—Ç –º—ã –ø–æ–ª—É—á–∏–ª–∏:
    if response.status_code == 200:
        # –ï—Å–ª–∏ –≤—Å—ë –æ–∫, —Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç –¥–∞–ª—å—à–µ –≤ –ø—Ä–æ–≥—Ä–∞–º–º—É
        return response.json()
    
    # –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª –Ω–∞–º –æ—à–∏–±–∫—É:
    elif response.status_code == 401:  # –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
        print("üõë  –û—à–∏–±–∫–∞! –ù–µ–≤–µ—Ä–Ω—ã–π API-–∫–ª—é—á. \n–ü—Ä–æ–≥—Ä–∞–º–º–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞.")
        sys.exit(0)
    elif response.status_code == 403:  # –ó–∞–ø—Ä–µ—â–µ–Ω–æ
        print("üõë  –û—à–∏–±–∫–∞! –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å API-–∫–ª—é—á–∞. \n–ü—Ä–æ–≥—Ä–∞–º–º–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞.")
        sys.exit(0)
    else:
        print(f"üõë  –û—à–∏–±–∫–∞! –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ: {response.status_code}. \n–ü—Ä–æ–≥—Ä–∞–º–º–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞.")
        sys.exit(0)

# –ö—Å—Ç–∞—Ç–∏, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–ª–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç–º–æ–¥–∑–∏ –ø—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ —Ä–∞–±–æ—Ç—ã —Å API - –ø–æ–ª–µ–∑–Ω–∞—è –≤–µ—â—å
# –¢–∞–∫–∏–º –ø–æ–¥—Ö–æ–¥–æ–º –ø–æ–ª—å–∑—É—é—Ç—Å—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –∫–æ–º–ø–∞–Ω–∏–∏ –í–ö–æ–Ω—Ç–∞–∫—Ç–µ. –ò—Ö –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ª–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –º–Ω–æ–≥–æ —ç–º–æ–¥–∑–∏, 
# —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ—â–µ –≤ –Ω–∏—Ö –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è

# –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å API-–∫–ª—é—á–æ–º
api_key_file = "API-key.txt"
api_key = read_api_key(api_key_file)

# print(api_key) # –ü—Ä–æ–≤–µ—Ä–∫–∞ API-–∫–ª—é—á–∞

# –•—Ä–∞–Ω–∏—Ç—å API-–∫–ª—é—á –≤ –∫–æ–¥–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, —ç—Ç–æ –æ—á–µ–Ω—å –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ. –ü–æ —ç—Ç–æ–º—É —è —Ö—Ä–∞–Ω—é —Å–≤–æ–π –∫–ª—é—á –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º .txt —Ñ–∞–π–ª–µ
# –ò —ç—Ç–æ –æ—á–µ–Ω—å –≤–∞–∂–Ω–æ –ø—Ä–æ–¥—É–º–∞—Ç—å –∑–∞—Ä–∞–Ω–µ–µ, —Ç.–∫. –µ—Å–ª–∏ –∑–∞–ø—É—à–∏—Ç—å –∫–æ–º–º–∏—Ç —Å API-–∫–ª—é—á–æ–º, –∏ –∑–∞—Ç–µ–º —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –¥–∞–ª—å—à–µ - 
# —Ç–æ —É–±—Ä–∞—Ç—å –µ–≥–æ –∏–∑ –∫–æ–¥–∞ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –≤ –±—É–¥—É—â–µ–º, –±—É–¥–µ—Ç —É–∂–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ

# –¢–∞–∫–∂–µ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ñ–∞–π–ª .gitignore, –Ω–æ –≤ —Ä–∞–º–∫–∞—Ö –¥–∞–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è 
# —è –æ—Å—Ç–∞–≤–ª—é —Ñ–∞–π–ª —Å API-–∫–ª—é—á–æ–º –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, —á—Ç–æ –±—ã —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –º–æ–∂–Ω–æ –±—ã–ª–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å


# –î–∞–ª–µ–µ, –≤—ã–±–∏—Ä–∞—é –≥–æ—Ä–æ–¥ –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥
city = "Yekaterinburg"
# –ò –æ—Ç–ø—Ä–∞–≤–ª—è—é –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–≥–æ–¥–µ
weather_data = get_weather(api_key, city) 

# –í—ã–≤–æ–∂—É –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–Ω—Å–æ–ª–∏:
print("")
print("–¢–µ–∫—É—â–∞—è –ø–æ–≥–æ–¥–∞ –≤ –≥–æ—Ä–æ–¥–µ –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥:")
print("")
print(f"–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {weather_data['current']['temp_c']}¬∞C")
print(f"–°–∫–æ—Ä–æ—Å—Ç—å –≤–µ—Ç—Ä–∞: {weather_data['current']['wind_kph']} –∫–º/—á")
print(f"–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ç—Ä–∞: {weather_data['current']['wind_dir']}")
print(f"–í–ª–∞–∂–Ω–æ—Å—Ç—å: {weather_data['current']['humidity']}%")
print("")
print(f"–î–∞–Ω–Ω—ã–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã –Ω–∞: {weather_data['current']['last_updated']}")




